---
title: "ONS76-CBO_Seurat_EXPLORE1_50K"
author: "JJ"
date: "11/08/2022"
output: html_document
---

```{r graphical_output}
options(bitmapType='cairo-png') # this line of code needed BEFORE knitr code in chunk below
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(dev = "png",
                      dpi = 300,
                      echo = TRUE,   # prints the code (if FALSE then only code output is shown)
                      cache = TRUE)
```

```{r libraries}
suppressPackageStartupMessages({
library(Seurat)
library(glmGamPoi)
library(Matrix)
library(ggVennDiagram)
library(patchwork)
library(tidyverse)
})
```

```{r}
# load full filtered (genes and cells) seurat object

filt.cboONS76.seurat <- readRDS("outputs50K/ONS76-CBO/filtCellsGenes.ons76cbo.seurat.rds")
```

```{r DimPlot1RiboMito}
# Perform SCTransform
# Perform dimensionality reduction by PCA and UMAP embedding
# FindClusters is run with only the default resolution parameter (= 0.8)
# 10 clusters identified

filt.cboONS76.seurat <- SCTransform(filt.cboONS76.seurat, method = "glmGamPoi", verbose = FALSE)

filt.cboONS76.seurat <- RunPCA(filt.cboONS76.seurat, verbose = FALSE)

filt.cboONS76.seurat <- RunUMAP(filt.cboONS76.seurat, dims = 1:30, verbose = FALSE)

filt.cboONS76.seurat <- FindNeighbors(filt.cboONS76.seurat, dims = 1:30, verbose = FALSE)

filt.cboONS76.clusters.seurat <- FindClusters(filt.cboONS76.seurat, verbose = FALSE)

DimPlot(filt.cboONS76.clusters.seurat, label = TRUE) # '+ NoLegend()' is an option to insert here
```

```
# saved the SCTransformed, clustered 'filt.cbo.clusters.seurat' Seurat object 
# to the folder 'outputs50K'. Running DimPlot() command on this object should generate the same
# UMAP projection every time

saveRDS(filt.cboONS76.clusters.seurat, file = "./outputs50K/ONS76-CBO/filt.cboONS76.clusters.seurat.rds")
```
```{r}
filt.cboONS76.clusters <- readRDS("outputs50K/ONS76-CBO/filt.cboONS76.clusters.seurat.rds")
```

```
# saved the last seurat object, 'filt.cboONS76.seurat'

saveRDS(filt.cboONS76.seurat, file = "./outputs50K/ONS76-CBO/filt.cboONS76.seurat.rds")
```
```{r}
filt.cboONS76 <- readRDS("outputs50K/ONS76-CBO/filt.cboONS76.seurat.rds")
```


```{r ElbowPlot1RiboMito}
# elbow plot shows that there is an elbow at PC ~10, but the graph does not level off after
# PC 15 showing there is some additional information to ~ PC 40.
# The input object is the CLUSTERED saved seurat object, and this gives the same result as
# the seurat object generated by the FindNeighbours() command.

ElbowPlot(filt.cboONS76.clusters, ndims = 50, reduction = "pca")
```

```{r}
# Find positive markers for each of the 11 clusters
cboONS76.cluster.markers <- FindAllMarkers(filt.cboONS76.clusters, min.pct = 0.25, only.pos = TRUE)
```

```{r}
# there are 2545 cells in total (BEFORE any ribosome filtering), which is correct, and the cell numbers 
# per cluster are shown below.

cell.num <- table(filt.cboONS76.clusters@active.ident)
cell.num
sum(cell.num)
```

```
# save cbo.cluster.markers as a csv file

write.csv(cboONS76.cluster.markers, "./outputs50K/ONS76-CBO/cboONS76.cluster.markers.csv", quote = F)
```

```{r load_cbo.cluster.markers}
cboONS76.cluster.markers <- read.csv("outputs50K/ONS76-CBO/cboONS76.cluster.markers.csv", 
                                    header = TRUE, 
                                    stringsAsFactors = FALSE)
```

```{r}
# cluster 0 top 10 markers
# cluster 0 = roof plate/choroid plexus
cluster0.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 0, ] %>%
  head(n=20)

cluster0.markers
```

```{r}
# cluster 1 top 10 markers
# cluster 1 = probable glia
cluster1.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 1, ] %>%
  head(n=20)

cluster1.markers
```

```{r}
# cluster 2 top 10 markers
# cluster 2 = 4th ventricle derivatives/choroid plexus
cluster2.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 2, ] %>%
  head(n=20)

cluster2.markers
```

```{r}
# cluster 3 top 10 markers
# cluster 3 = GCP/granule neuron
cluster3.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 3, ] %>%
  head(n=20)

cluster3.markers
```

```{r}
# cluster 4 top 10 markers
# cluster 4 = rhombic lip/GCP lineage
cluster4.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 4, ] %>%
  head(n=20)

cluster4.markers
```

```{r}
# cluster 5 top 10 markers
# cluster 5 = ?ONS76 cells
cluster5.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 5, ] %>%
  head(n=20)

cluster5.markers
```

```{r}
# cluster 6 top 10 markers
# cluster 6 = could be inhibitory GABAergic cerebellar nuclei/interneurons/PN
cluster6.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 6, ] %>%
  head(n=20)

cluster6.markers
```

```{r}
# cluster 7 top 10 markers
# cluster 7 = GCP/granule neuron
cluster7.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 7, ] %>%
  head(n=20)

cluster7.markers
```

```{r}
# cluster 8 top 10 markers
# cluster 8 = ?glia (but could these be ONS76 cells??)
cluster8.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 8, ] %>%
  head(n=20)

cluster8.markers
```

```{r}
# cluster 9 top 20 markers
# cluster 9 =  most likely glia 
cluster9.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 9, ] %>%
  head(n=20)

cluster9.markers
```

```{r}
# cluster 10 top 20 markers
# cluster 10 = ONS76 cells
cluster10.markers <- cboONS76.cluster.markers[cboONS76.cluster.markers$cluster == 10, ] %>%
  head(n=20)

cluster10.markers
```

***COMMENT***
cluster 5 contained many ribosomal genes, so TRY FILTERING ON RIBOSOMAL GENE PERCENTAGE
#----------------------------------------------------------------------------------------

use the full filtered (for cells and genes and mitoch percent) seurat object


```{r}
# load full filtered (genes and cells) seurat object

filt.cboONS76.seurat <- readRDS("outputs50K/ONS76-CBO/filtCellsGenes.ons76cbo.seurat.rds")
```

```{r}
# calculate ribosomal percentage

filt.cboONS76.seurat[["percent.ribo"]] <- PercentageFeatureSet(filt.cboONS76.seurat, pattern = "^RP[SL]")
```

```{r}
summary(filt.cboONS76.seurat@meta.data$percent.ribo)
```

```{r}
VlnPlot(filt.cboONS76.seurat, features = c("percent.mt", "percent.ribo"), ncol = 3)
```

```{r}
# FILTER OUT ALL RIBOSOMAL GENES, THEN ALL MITOCHONDRIAL GENES (ON THE CELLS WHICH HAVE ALREADY BEEN REMOVED
# THAT HAVE PERCENT.MITO < 10% BEFORE DOING THE CLUSTERING), DON'T REMOVE ANY MORE ACTUAL CELLS
#-------------------------------------------------------------------------------------

# remove ribosomal genes first
filt.noRibo.ons76cbo <- filt.cboONS76.seurat[ ! grepl('^RP[SL]', rownames(filt.cboONS76.seurat)), ]
```

```{r}
# check ribosomal genes removed:
# this has worked - 97 ribosomal genes have been removed from the new Seurat object

dim(filt.cboONS76.seurat)
dim(filt.noRibo.ons76cbo)
```

```{r}
# remove mitochondrial genes 
filt.noRiboMito.ons76cbo <- filt.noRibo.ons76cbo[ ! grepl("^MT-", rownames(filt.noRibo.ons76cbo)), ]
```

```{r}
# check if ribosome and mitochondrial gene filtering works - it does!
dim(filt.noRibo.ons76cbo)
dim(filt.noRiboMito.ons76cbo)
```

```
# save the ribosome gene-filtered and mitochondrial gene-filtered seurat object.

saveRDS(filt.noRiboMito.ons76cbo, file = "./outputs50K/ONS76-CBO/filt.NoRiboNoMito.cboONS76.rds")
```

```{r}
# load the cell AND GENE AND mitoch AND ribosomal gene filtered object

filt.noRiboMito.ons76cbo <- readRDS("outputs50K/ONS76-CBO/filt.NoRiboNoMito.cboONS76.rds")
```

```{r DimPlot2NoRiboNoMito}
# Perform SCTransform
# Perform dimensionality reduction by PCA and UMAP embedding
# FindClusters is run with only the default resolution parameter (= 0.8)
# XX clusters identified

filt.noRiboMito.ons76cbo <- SCTransform(filt.noRiboMito.ons76cbo, method = "glmGamPoi", verbose = FALSE)

filt.noRiboMito.ons76cbo <- RunPCA(filt.noRiboMito.ons76cbo, verbose = FALSE)

filt.noRiboMito.ons76cbo <- RunUMAP(filt.noRiboMito.ons76cbo, dims = 1:30, verbose = FALSE)

filt.noRiboMito.ons76cbo <- FindNeighbors(filt.noRiboMito.ons76cbo, dims = 1:30, verbose = FALSE)

filt.noRiboMito.ons76cbo.clusters <- FindClusters(filt.noRiboMito.ons76cbo, verbose = FALSE)

DimPlot(filt.noRiboMito.ons76cbo.clusters, label = TRUE) # '+ NoLegend()' is an option to insert here
```

```
# SAVE THE 'filt.noRiboMito.ons76cbo.clusters' seurat object

saveRDS(filt.noRiboMito.ons76cbo.clusters, file = "./outputs50K/ONS76-CBO/filt.noRiboMito.ons76cbo.clusters.rds")
```

```{r}
# load the saved clustered seurat object with ribosome and mitoch genes removed

filt.noRiboMito.ons76cbo.clusters <- readRDS("outputs50K/ONS76-CBO/filt.noRiboMito.ons76cbo.clusters.rds")
```

```{r}
# Find positive markers for each of the 11 clusters of 'filt.noRiboMito.cbo.clusters'

ons76cbo.cluster.markers.noRiboMito <- FindAllMarkers(filt.noRiboMito.ons76cbo.clusters, min.pct = 0.25, only.pos = TRUE)
```

```{r}
# find cell counts per cluster
# there are 2545 cells in total, which is correct, and the cell numbers per cluster are shown below.

cell.num.riboFilt <- table(filt.noRiboMito.ons76cbo.clusters@active.ident)
cell.num.riboFilt
sum(cell.num.riboFilt)
```

```{r}
# save 'ons76cbo.cluster.markers.noRiboMito' as a csv file. This object has NO mitochondrial 
# or ribosomal genes.
# The object has already been filtered to keep cells with mitoch gene expression < 10%.

write.csv(ons76cbo.cluster.markers.noRiboMito,
          "./outputs50K/ONS76-CBO/ons76cbo.cluster.markers.noRiboMito.csv", 
          quote = F)
```

```{r}
# load the csv file
ons76cbo.cluster.markers.noRiboMito <- read.csv(
                                      "outputs50K/ONS76-CBO/ons76cbo.cluster.markers.noRiboMito.csv", 
                                       header = TRUE, 
                                       stringsAsFactors = FALSE)
```

```{r}
# cluster 0 no ribo and no mitoch top 10 markers
# cluster 0 manual = roof plate/CP 

cluster0.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 0, ] %>%
  head(n=10)

cluster0.markers
```

```{r}
# cluster 0 no ribo and no mitoch top 10 markers
# cluster 1 manual = possible glia??
cluster1.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 1, ] %>%
  head(n=10)

cluster1.markers
```

```{r}
# cluster 2 no ribo and no mitoch top 20 markers
# cluster 2 manual = GCP/granule but could be ONS76

cluster2.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 2, ] %>%
  head(n=20)

cluster2.markers
```

```{r}
# cluster 3 no ribo and no mitoch top 10 markers
# cluster 3 manual = CP/4th ventricle

cluster3.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 3, ] %>%
  head(n=10)

cluster3.markers
```

```{r}
# cluster 4 no ribo and no mitoch top 30 markers
# cluster 4 manual = possible glia
cluster4.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 4, ] %>%
  head(n=30)

cluster4.markers
```

```{r}
# cluster 5 no ribo and no mitoch top 10 markers
# cluster 5 manual = possible inhibitory GABAergic cerebellar nuclei/interneurons/PN

cluster5.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 5, ] %>%
  head(n=10)

cluster5.markers
```

```{r}
# cluster 6 no ribo and no mitoch top 20 markers
# cluster 6 manual = GCP/granule neuron - a bit more similar to cluster 6 of CBO sample

cluster6.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 6, ] %>%
  head(n=20)

cluster6.markers
```

```{r}
# cluster 7 no ribo and no mitoch top 20 markers
# cluster 7 manual = glial cells

cluster7.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 7, ] %>%
  head(n=10)

cluster7.markers
```

```{r}
# cluster 8 no ribo and no mitoch top 20 markers
# cluster 8 manual = rhombic lip, GCP, proliferative granule cells

cluster8.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 8, ] %>%
  head(n=10)

cluster8.markers
```

```{r}
# cluster 9 no ribo and no mitoch top 20 markers
# cluster 9 manual = granule/GCP lineage
cluster9.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 9, ] %>%
  head(n=10)

cluster9.markers
```

```{r}
# cluster 10 no ribo and no mitoch top 20 markers
# cluster 10 manual = ONS76 cells?
cluster10.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 10, ] %>%
  head(n=20)

cluster10.markers
```

```{r DotplotAllSeppMarkersAndCilia, fig.height=10}
# from the Sepp paper repeat Dotplot with TF and some key non-TF markers
# added markers of ciliated cells from cluster10 above.
# used the argument col.min = 0 so that average expression scale is from 0 to 2.5 in key

sepp.all.markers <- c("TFAP2A", "PAX3", "RFX4", "TCFL71", "TCF7L2", "GLIS3", "SOX6", "HOPX", "TSC22D4",  
                      "ID4", "NCKAP5", "SLIT2", "CLYBL", "SLC1A3", "SLC6A11", "AQP4",  #astroglial/progenitor
                      
                      "ESRRB", "FOXP1", "FOXP2", "FOXP4", "MEF2C", "RORB", "CDH9", "ETV1", "EBF1", "EBF2", 
                      "SKOR2", "DAB1", "IPTR",   # Purkinje
                      
                      "NOTCH1",    # VZ neuroblast
             
                      "PAX2", "NFIA", "NFIB", "TFAP2B", "BHLHE22", "PRDM8",  # interneuron
                      
                      "ZFHX3", "ZFHX4",   # GABAergic deep nuclei neurons
             
                      "TOP2A", "ATOH1", "LMX1A", "OTX2","ETV6", "PAX6", "BARHL1", "E2F3", "ST18", "SATB2", 
                      "ZBTB18", "NEUROD1", "ZIC1", "ZIC4", "GABAR6", "CNTN1", "CNTN2", "KLF9", "NR3C1", "LMO3", 
                      "SYNPR", "KCNIP4", "HCRTR2", 
                      "EOMES", "TRPC3", "GRM1")
                      # UBC/GCP/granule/glut deep cerebellar nuclei                                                                   
seppAll.cilia.stem.markers <- c(sepp.all.markers, "CCNO", "CFAP299", "ROPN1L", "C11orf88", "ANKRD66", "C20orf85", 
                                "STOML3", "TEKT4", "SNTN", "MEIS1", "POU3F2", "HOXB2", "MEIS2", "GRIA4")

DotPlot(object = filt.noRiboMito.ons76cbo.clusters, features = seppAll.cilia.stem.markers, col.min = 0) +
  coord_flip()
```

```{r ViolinPlotGranuleClusterGenes, fig.height=10}
# plot of the clusters containing granule/RL lineage - clusters 2, 4, 6, 9 and 10 contain RL/granule
# lineage.
# CDH1 is expressed (in WT cells and ONS76 cells), but CDH5 (marker of ONS76 cells) is not expressed.
# CD44 is not expressed or expressed very little.
# ITGB1 is also not good at discriminating WT CBO from ONS76-CBO samples

VlnPlot(filt.noRiboMito.ons76cbo.clusters, 
        features = c("HOXB2", "NEUROD1", "CNTN1", "CNTN2", "MEIS1", "MEIS2", "GRIA4", "POU3F2", "RRM2", "ACTC1"))
```

```{r}
# CHECK ABOVE CANDIDATE GENES WHICH ARE UPREGULATED IN ONS76 CELLS VS WT CELLS IN CO-CULTURE
#----------------------------------------------------------------------------------------------------
# CLUSTER 2, MEIS1 expression in cells: pct.1 = 28%, pct.2 (all other cells) = 7%, avg_log2FC = 0.429;
# adj p-val = 1.871e-27

# CLUSTER 10, CNTN2 expression in cells: pct.1 = 44%, pct.2 = 9%, avg_log2FC = 1.150;
# adj p-val = 1.736e-20

cntn2.clusters.2.10 <- ons76cbo.cluster.markers.noRiboMito[((ons76cbo.cluster.markers.noRiboMito$cluster == 2 | ons76cbo.cluster.markers.noRiboMito$cluster == 10) & ons76cbo.cluster.markers.noRiboMito$gene == "CNTN2"), ]

cntn2.clusters.2.10
```

```{r}
# CLUSTER 10, MEIS1 expression in cells: pct.1 = 70%, pct.2 = 2%, avg_log2FC = 1.783;
# adj p-val = 2.349e-195

meis1.cluster.10 <- ons76cbo.cluster.markers.noRiboMito[(ons76cbo.cluster.markers.noRiboMito$cluster == 10 & ons76cbo.cluster.markers.noRiboMito$gene == "MEIS1"), ]

meis1.cluster.10
```

```{r}
# CLUSTER 10, GRIA4 expression in cells: pct.1 = 29%, pct.2 = 1%, avg_log2FC = 0.688;
# adj p-val = 1.721e-60

gria4.cluster.10 <- ons76cbo.cluster.markers.noRiboMito[(ons76cbo.cluster.markers.noRiboMito$cluster == 10 & ons76cbo.cluster.markers.noRiboMito$gene == "GRIA4"), ]

gria4.cluster.10
```

```{r}
# CLUSTER 10, POU3F2 expression in cells: pct.1 = 50%, pct.2 = 0.9%, avg_log2FC = 0.997;
# adj p-val = 7.905e-169

pou3f2.cluster.10 <- ons76cbo.cluster.markers.noRiboMito[(ons76cbo.cluster.markers.noRiboMito$cluster == 10 & ons76cbo.cluster.markers.noRiboMito$gene == "POU3F2"), ]

pou3f2.cluster.10
```

```{r}
# ISOLATE AND EXTRACT ONLY ONS76 CELLS
#------------------------------------------------------------------------------------------------------
# reminder there are 11 clusters
levels(filt.noRiboMito.ons76cbo.clusters)

# ons76 cells are in clusters 6, 9 and 10 of ONS76-CBO sample - isolate and extract these cells
ons76.cells.cocult <- subset(filt.noRiboMito.ons76cbo.clusters, idents = c("6", "9", "10"))
dim(ons76.cells.cocult)
```

```
# save the ons76.cells.cocult seurat object

saveRDS(ons76.cells.cocult, file = "./outputs50K/ONS76-CBO/ons76.cells.only.rds")
```

```{r}
# load the seurat object

ons76.cells.cocult <- readRDS(file = "outputs50K/ONS76-CBO/ons76.cells.only.rds")
```

***Venn diagrams for overlap of upregulated genes***

```{r}
cluster2.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 2, ]
cluster6.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 6, ]
cluster9.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 9, ]
cluster10.markers <- ons76cbo.cluster.markers.noRiboMito[ons76cbo.cluster.markers.noRiboMito$cluster == 10, ]
```


```{r}
write.csv(cluster2.markers, file = "./outputs50K/DEG_VennDiag/ONS76cbo_cluster2.csv")
write.csv(cluster6.markers, file = "./outputs50K/DEG_VennDiag/ONS76cbo_cluster6.csv")
write.csv(cluster9.markers, file = "./outputs50K/DEG_VennDiag/ONS76cbo_cluster9.csv")
write.csv(cluster10.markers, file = "./outputs50K/DEG_VennDiag/ONS76cbo_cluster10.csv")
```

```{r}
ONS76cbo_clus2 <- read.csv("outputs50K/DEG_VennDiag/ONS76cbo_cluster2.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)
ONS76cbo_clus6 <- read.csv("outputs50K/DEG_VennDiag/ONS76cbo_cluster6.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)
ONS76cbo_clus9 <- read.csv("outputs50K/DEG_VennDiag/ONS76cbo_cluster9.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)
ONS76cbo_clus10 <- read.csv("outputs50K/DEG_VennDiag/ONS76cbo_cluster10.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)
cbo_clus6_granule <- read.csv("outputs50K/DEG_VennDiag/cbo_cluster6_granule.csv",
                           header = TRUE,
                           stringsAsFactors = FALSE)
```

```{r VennDiagClus6CBOvsClus6ONS76CBO}
gene_list1 <- list(cbo_clus6_granule$gene, ONS76cbo_clus6$gene)
cbo.clus6.granule_ons76cbo.clus6 <- ggVennDiagram(gene_list1, category.names = c("cbo_clus6_granule", "ONS76cbo_clus6"))
cbo.clus6.granule_ons76cbo.clus6
```

```{r VennDiagClus6CBOvsClus2ONS76CBO}
# cluster 2 in ONS76-CBO and cluster 6 in CBO seem to share the greatest percentage of genes,
# so it is likely that CBO cluster 6 and ONS76-CBO cluster 2 are the most similar

gene_list2 <- list(cbo_clus6_granule$gene, ONS76cbo_clus2$gene)
cbo.clus6.granule_ons76cbo.clus2 <- ggVennDiagram(gene_list2, category.names = c("cbo_clus6_granule", "ONS76cbo_clus2"))
cbo.clus6.granule_ons76cbo.clus2
```

```{r VennDiagClus6CBOvsClus9ONS76CBO}
gene_list3 <- list(cbo_clus6_granule$gene, ONS76cbo_clus9$gene)
cbo.clus6.granule_ons76cbo.clus9 <- ggVennDiagram(gene_list3, category.names = c("cbo_clus6_granule", "ONS76cbo_clus9"))
cbo.clus6.granule_ons76cbo.clus9
```

```{r VennDiagClus6CBOvsClus10ONS76CBO}
gene_list4 <- list(cbo_clus6_granule$gene, ONS76cbo_clus10$gene)
cbo.clus6.granule_ons76cbo.clus10 <- ggVennDiagram(gene_list4, category.names = c("cbo_clus6_granule", "ONS76cbo_clus10"))
cbo.clus6.granule_ons76cbo.clus10
```








